[{"id":"df862dc9.786fd","type":"inject","z":"ba705cfb.7ee0a","name":"Get calllist","topic":"","payload":"","payloadType":"date","repeat":"60","crontab":"","once":true,"onceDelay":0.1,"x":250,"y":1920,"wires":[["db8c5bd2.dd2eb8"]]},{"id":"ed5632c3.3e17","type":"comment","z":"ba705cfb.7ee0a","name":"Show Calllist","info":"","x":190,"y":1880,"wires":[]},{"id":"db8c5bd2.dd2eb8","type":"fritzbox-calllist","z":"ba705cfb.7ee0a","device":"358f95ae.ef43ea","name":"","action":"","max":"10","maxdays":"","x":470,"y":1920,"wires":[["6f0ec0b4.3a573"]]},{"id":"6f0ec0b4.3a573","type":"function","z":"ba705cfb.7ee0a","name":"collectData","func":"\nvar callListEntries = [];\nvar incAnswCallListEntries = [];\nvar missedCallListEntries = [];\nvar outgoingCallListEntries = [];\n\n    for (var i = 0; (i<msg.payload.Call.length && i<20); i++)\n    {\n        if (msg.payload.Call[i].Type!==undefined)\n        {\n            var inOrOut=\"-\";\n            if(msg.payload.Call[i].Type==1)\n            {\n                //Eingehender Angenommener Anruf\n                inOrOut=\"> incoming answ.\";\n                \n                incAnswCallListEntries.push({\n                direction:  inOrOut,\n                date:  msg.payload.Call[i].Date,\n                name:  msg.payload.Call[i].Name,\n                number:  msg.payload.Call[i].Caller\n                });\n            } else if(msg.payload.Call[i].Type==2)\n            {\n                //Eingehender Nicht-Angenommener Anruf\n                inOrOut=\">> missed\";\n                \n                missedCallListEntries.push({\n                direction:  inOrOut,\n                date:  msg.payload.Call[i].Date,\n                name:  msg.payload.Call[i].Name,\n                number:  msg.payload.Call[i].Caller\n                });\n            } else if(msg.payload.Call[i].Type==3)\n            {\n                //Ausgehender Nicht-Angenommener Anruf\n                inOrOut=\"<< outgoing\";\n                \n                outgoingCallListEntries.push({\n                direction:  inOrOut,\n                date:  msg.payload.Call[i].Date,\n                name:  msg.payload.Call[i].Name,\n                number:  msg.payload.Call[i].Caller\n                });\n            }\n            \n            callListEntries.push({\n            direction:  inOrOut,\n            date:  msg.payload.Call[i].Date,\n            name:  msg.payload.Call[i].Name,\n            number:  msg.payload.Call[i].Caller\n            });\n        }\n    }\n\nvar msgNew= {payload: callListEntries};\nmsgNew.incAnsw=incAnswCallListEntries;\nmsgNew.missed=missedCallListEntries;\nmsgNew.outgoing=outgoingCallListEntries;\nreturn msgNew;","outputs":1,"noerr":0,"x":690,"y":1920,"wires":[["ed0678b3.1c6c98","ddf9b2c0.049d5","b2c8c704.bb61b8","8b7f87c9.120bf8","f3f3769c.7037a8"]]},{"id":"ed0678b3.1c6c98","type":"ui_table","z":"ba705cfb.7ee0a","group":"abc07dab.63606","name":"FritzBox-Calllist-all","order":1,"width":"20","height":"10","columns":[{"field":"direction","title":"direction","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"date","title":"date","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"name","title":"name","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"number","title":"number","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}}],"outputs":0,"cts":false,"x":930,"y":1920,"wires":[]},{"id":"ddf9b2c0.049d5","type":"change","z":"ba705cfb.7ee0a","name":"incAnsw","rules":[{"t":"set","p":"payload","pt":"msg","to":"incAnsw","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":1960,"wires":[["ac3cb12b.6b9d8"]]},{"id":"b2c8c704.bb61b8","type":"change","z":"ba705cfb.7ee0a","name":"missed","rules":[{"t":"set","p":"payload","pt":"msg","to":"missed","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":2000,"wires":[["cf4b41d0.417e3"]]},{"id":"8b7f87c9.120bf8","type":"change","z":"ba705cfb.7ee0a","name":"outgoing","rules":[{"t":"set","p":"payload","pt":"msg","to":"outgoing","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":2040,"wires":[["728a7c24.88f024"]]},{"id":"ac3cb12b.6b9d8","type":"ui_table","z":"ba705cfb.7ee0a","group":"abc07dab.63606","name":"FritzBox-Calllist-incoming-answered","order":1,"width":"20","height":"10","columns":[{"field":"direction","title":"direction","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"date","title":"date","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"name","title":"name","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"number","title":"number","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}}],"outputs":0,"cts":false,"x":1170,"y":1960,"wires":[]},{"id":"cf4b41d0.417e3","type":"ui_table","z":"ba705cfb.7ee0a","group":"abc07dab.63606","name":"FritzBox-Calllist-missed","order":1,"width":"20","height":"10","columns":[{"field":"direction","title":"direction","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"date","title":"date","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"name","title":"name","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"number","title":"number","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}}],"outputs":0,"cts":false,"x":1130,"y":2000,"wires":[]},{"id":"728a7c24.88f024","type":"ui_table","z":"ba705cfb.7ee0a","group":"abc07dab.63606","name":"FritzBox-Calllist-outgoing","order":1,"width":"20","height":"10","columns":[{"field":"direction","title":"direction","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"date","title":"date","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"name","title":"name","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"number","title":"number","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}}],"outputs":0,"cts":false,"x":1130,"y":2040,"wires":[]},{"id":"f3f3769c.7037a8","type":"debug","z":"ba705cfb.7ee0a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":890,"y":1880,"wires":[]},{"id":"358f95ae.ef43ea","type":"fritzbox-config","z":"","name":"fritzBox","host":"fritz.box","port":"49000","ssl":false},{"id":"abc07dab.63606","type":"ui_group","z":"","name":"Telefon","tab":"b881d91c.f73d98","disp":true,"width":"20","collapse":false},{"id":"b881d91c.f73d98","type":"ui_tab","z":"","name":"Status","icon":"dashboard","order":4,"disabled":false,"hidden":false}]